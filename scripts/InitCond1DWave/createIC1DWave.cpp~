#include <iostream>
#include <fstream>
#include <cstring>
#include <iomanip>
#include <cstdio>
#include <cstdlib>
#include <math.h>

using namespace std;

int main () {
  
  const double PI= 3.1415926535;
  char Key_word[125];
  double x=0;
  const double p_0=1;
  const double gamma=1.4;//gamma air
  const double rho=1;// density (considered constant)
  const int N=100;// number of particles
  const double domain_size=1.0;
 
  const double dx=domain_size/N;// distance between two particles
  const double m=rho*dx;// particle mass (the same for each particle)

  double x_array[N];
  double y_array[N];
  double vx_array[N];
  double vy_array[N];
  double p_array[N];
  double rho_array[N];

  double c_s0=sqrt(gamma*p_0/rho);
  cout<<setprecision (8)<<"sound speed is: "<<c_s0<<endl;
  for(int i=0;i<N;i++) {
    x_array[i]=x;
    x=x+dx;
    y_array[i]=0;
    vx_array[i]=0.05*c_s0*sin(2*PI*x);
    vy_array[i]=0;
    p_array[i]=p_0-rho/2*pow(vx_array[i],2);
    rho_array[i]=rho;
  };
  
  
  ofstream out("../../cases/1DWaveRhoConst.ivs");
  
  out<<N<<endl;
  
  for(int i=0;i<N;i++)
    {
      out <<setprecision (8)
	  <<"   "<<x_array[i]
	  <<"   "<<y_array[i]
	  <<"   "<<vx_array[i]
	  <<"   "<<vy_array[i]
	  <<"   "<<rho_array[i]
	  <<"   "<<p_array[i]
	  <<"   "<<m<<endl;
    };
  
  out.close();
  cout<<"1DWaveRhoConst.ivs successfully written in <<sph-blitz/cases>>\n";
}
